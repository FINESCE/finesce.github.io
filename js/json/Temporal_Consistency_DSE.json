[
    {
        "Last Update": "2015-09-04",
        "Target Usage": "",
        "Name": "Temporal Consistency DSE",
        "Short Description": "",
        "Documentation": {
            "Description": "\n\n<h3>\n Basic Concepts\n</h3>\n\n<p>\n The Temporal Consistency DSE functionalities are enabled by a Java module running within the server hosting the DSE, that is in charge of periodically performing temporal consistency analysis over the data stored in Cosmos GE. The results of the analysis are loaded into a database hosted in the same server as the Java module. A prototype web interface has been developed for testing the correct operation of the DSE.\n</p>\n\n<p>\n The screenshot in the figure below shows how the Temporal Consistency DSE is applied to the weather forecasts (more especifically, the temperature predictions) coming from the weather forecast module of the Madrid trial. Through the application of the algorithm of the previously mentioned temporal consistency analysis, predictions that are considered erroneous bare detected and replaced by alternative values also calculated by the algorithm.\n</p>\n\n<p style=\"text-align:center;\">\n <img alt=\"\" src=\"images/redmine/TemporalConsistencyDSE.png\" class=img-responsive />\n</p>\n\n\n<h3>\n Basic Design Principles\n</h3>\n\n<p>\n This section provides a basic overview of the information model and classes that have been developed for the Temporal Consistency DSE. The overview focuses on the specific usage case of the DSE integrated with the weather forecast service of the Madrid trial.\n</p>\n\n<p>\n <ins>\n  <strong>\n   a\n  </strong>\n  ) Load data:\n </ins>\n sample of measurement data retrieved programmatically from the weather forecasting module. Data load example:\n</p>\n\n<blockquote>\n <p>\n  Request\n </p>\n</blockquote>\n\n<pre>\nhttp://orioncb_ip:port/updateContext\nContent-Type:\n    application/xml\nRequest body:\n    &lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt; \n    &lt;updateContextRequest&gt;\n        &lt;contextElementList&gt;\n            &lt;contextElement&gt;\n                &lt;entityId type=\"finesce_meteo\" isPattern=\"false\"&gt;\n                    &lt;id&gt;finesce_meteo&lt;/id&gt; \n                &lt;/entityId&gt;\n                &lt;contextAttributeList&gt;\n                    &lt;contextAttribute&gt;\n                        &lt;name&gt;temp&lt;/name&gt; \n                        &lt;type&gt;C&lt;/type&gt; \n                        &lt;contextValue&gt;4.89&lt;/contextValue&gt; \n                    &lt;/contextAttribute&gt;\n                    &lt;contextAttribute&gt;\n                        &lt;name&gt;humrel&lt;/name&gt; \n                        &lt;type&gt;pct&lt;/type&gt; \n                        &lt;contextValue&gt;0.88&lt;/contextValue&gt; \n                    &lt;/contextAttribute&gt;\n                    &lt;contextAttribute&gt;\n                        &lt;name&gt;precip&lt;/name&gt; \n                        &lt;type&gt;mmh&lt;/type&gt; \n                        &lt;contextValue&gt;0.0315&lt;/contextValue&gt; \n                    &lt;/contextAttribute&gt;\n                    &lt;contextAttribute&gt;\n                        &lt;name&gt;modviento&lt;/name&gt; \n                        &lt;type&gt;ms&lt;/type&gt; \n                        &lt;contextValue&gt;0.01&lt;/contextValue&gt; \n                    &lt;/contextAttribute&gt;\n                    &lt;contextAttribute&gt;\n                        &lt;name&gt;dirviento&lt;/name&gt; \n                        &lt;type&gt;grad&lt;/type&gt; \n                        &lt;contextValue&gt;265&lt;/contextValue&gt; \n                    &lt;/contextAttribute&gt;\n                    &lt;contextAttribute&gt;\n                        &lt;name&gt;cc&lt;/name&gt; \n                        &lt;type&gt;pct&lt;/type&gt; \n                        &lt;contextValue&gt;0.2&lt;/contextValue&gt; \n                    &lt;/contextAttribute&gt;\n                &lt;/contextAttributeList&gt;\n            &lt;/contextElement&gt;\n        &lt;/contextElementList&gt;\n        &lt;updateAction&gt;APPEND&lt;/updateAction&gt; \n    &lt;/updateContextRequest&gt;\n</pre>\n\n<blockquote>\n <p>\n  Response\n </p>\n</blockquote>\n\n<pre>\nResponse code:\n    200 OK\nContent-Type:\n    application/xml\nResponse body:\n    &lt;updateContextResponse&gt;\n      &lt;contextResponseList&gt;\n        &lt;contextElementResponse&gt;\n          &lt;contextElement&gt;\n            &lt;entityId type=\"finesce_meteo\" isPattern=\"false\"&gt;\n              &lt;id&gt;finesce_meteo&lt;/id&gt;\n            &lt;/entityId&gt;\n            &lt;contextAttributeList&gt;\n              &lt;contextAttribute&gt;\n                &lt;name&gt;temp&lt;/name&gt;\n                &lt;type&gt;C&lt;/type&gt;\n                &lt;contextValue&gt;&lt;/contextValue&gt;\n              &lt;/contextAttribute&gt;\n              &lt;contextAttribute&gt;\n                &lt;name&gt;humrel&lt;/name&gt;\n                &lt;type&gt;pct&lt;/type&gt;\n                &lt;contextValue&gt;&lt;/contextValue&gt;\n              &lt;/contextAttribute&gt;\n              &lt;contextAttribute&gt;\n                &lt;name&gt;precip&lt;/name&gt;\n                &lt;type&gt;mmh&lt;/type&gt;\n                &lt;contextValue&gt;&lt;/contextValue&gt;\n              &lt;/contextAttribute&gt;\n              &lt;contextAttribute&gt;\n                &lt;name&gt;modviento&lt;/name&gt;\n                &lt;type&gt;ms&lt;/type&gt;\n                &lt;contextValue&gt;&lt;/contextValue&gt;\n              &lt;/contextAttribute&gt;\n              &lt;contextAttribute&gt;\n                &lt;name&gt;dirviento&lt;/name&gt;\n                &lt;type&gt;grad&lt;/type&gt;\n                &lt;contextValue&gt;&lt;/contextValue&gt;\n              &lt;/contextAttribute&gt;\n              &lt;contextAttribute&gt;\n                &lt;name&gt;cc&lt;/name&gt;\n                &lt;type&gt;pct&lt;/type&gt;\n                &lt;contextValue&gt;&lt;/contextValue&gt;\n              &lt;/contextAttribute&gt;\n            &lt;/contextAttributeList&gt;\n          &lt;/contextElement&gt;\n          &lt;statusCode&gt;\n            <code>200</code><br/>            &lt;reasonPhrase&gt;OK&lt;/reasonPhrase&gt;<br/>          &lt;/statusCode&gt;<br/>        &lt;/contextElementResponse&gt;<br/>      &lt;/contextResponseList&gt;<br/>    &lt;/updateContextResponse&gt;<br/></pre>\n<br/>\n<ins>\n <em>\n  Meteo class:\n </em>\n</ins>\n The class of the information model which stores the load data is Meteo. This class supports all services to retrieve predictions.\n\n\t<p style=\"text-align:center;\">\n <img alt=\"\" src=\"images/redmine/ClassMeteo.png\" class=img-responsive />\n</p>\n\n<p>\n <em>\n  Methods:\n </em>\n There is a method for retrieving the forecasts of each weather parameter provided by the module. The method get temperature is provided below as an example.\n</p>\n\n<blockquote>\n <p>\n  Get Temperature: This method provides the temperature forecasts for a GPS location over a time interval. This method accepts GET parameters:\n </p>\n</blockquote>\n\n<ul>\n <li>\n  <em>\n   method\n  </em>\n  It shall be a String, representing the format of output data. There are two possible values:\n  <ul>\n   <li>\n    json\n   </li>\n   <li>\n    xml\n   </li>\n  </ul>\n </li>\n <li>\n  <em>\n   fecha_ini\n  </em>\n  It shall be an Integer representing a date in UNIX_TIMESTAMP format.\n </li>\n <li>\n  <em>\n   fecha_fin\n  </em>\n  It shall be an Integer representing a date in UNIX_TIMESTAMP format.\n </li>\n <li>\n  <em>\n   last\n  </em>\n  It shall be an Integer, representing how many values the service will provide.\n </li>\n <li>\n  <em>\n   number_of_hours\n  </em>\n  It shall be an Integer, representing how many values the service will provide, starting on \u201cfecha_ini\u201d. This parameter can\u2019t be used combined with \u201cfecha_fin\u201d.\n </li>\n</ul>\n\n<p>\n <em>\n  Example\n </em>\n</p>\n\n<blockquote>\n <p>\n  GET\n </p>\n</blockquote>\n\n<pre>\nhttp://s414608724.mialojamiento.es/FINESCE/api/{module_name}/{function_name}/?parameters\n</pre>\n\n<blockquote>\n <p>\n  Example using JSON\n </p>\n</blockquote>\n\n<pre>\nhttp://s414608724.mialojamiento.es/FINESCE/api/wf/temp/?method=json&amp;last=3&amp;number_of_hours=3&amp;fecha_ini=1421931600\n\nREQUEST\n\nACCEPT     \n    application/json\n\nRESPONSE\nResponse code:     \n    200 OK\nContent-Type:        \n    application/json\nResponse body:    \n    {\"meteo\": [\n        { \n            \"parameter\":\"temp\" ,  \n            \"value\":\"6.29\" ,  \n            \"timestamp\":\"2015-01-22 16:00:00\" ,  \n            \"entity\":\"meteo\" ,  \n            \"scope\":\"cell\" \n        },\n        { \n            \"parameter\":\"temp\" ,  \n            \"value\":\"6.98\" ,  \n            \"timestamp\":\"2015-01-22 15:00:00\" ,  \n            \"entity\":\"meteo\" ,  \n            \"scope\":\"cell\" \n        },\n        { \n            \"parameter\":\"temp\" ,  \n            \"value\":\"6.94\" ,  \n            \"timestamp\":\"2015-01-22 14:00:00\" ,  \n            \"entity\":\"meteo\" ,  \n            \"scope\":\"cell\" \n        }\n    ]}\n</pre>\n\n<blockquote>\n <p>\n  Example using XML\n </p>\n</blockquote>\n\n<pre>\nhttp://s414608724.mialojamiento.es/FINESCE/api/wf/temp/?method=xml&amp;last=3&amp;number_of_hours=3&amp;fecha_ini=1421931600\n\nREQUEST\n\nACCEPT\n    application/xml\n\nRESPONSE\nResponse code:\n    200 OK\nContent-Type:\n    application/xml\nResponse body:\n    &lt;contextML xmlns=\"http://ContextML/1.7\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"  xsi:schemaLocation=\"http://ContextML/1.7 ../ContextML-1.7.xsd\"&gt;\n        &lt;ctxEls&gt;\n            &lt;ctxEl&gt;\n                &lt;contextProvider id=\"MyClient\" v=\"1.2.1\"&gt;&lt;/contextProvider&gt;\n                &lt;entity id=\"123456789123\" type=\"imei\"&gt;&lt;/entity&gt;\n                &lt;scope&gt;cell&lt;/scope&gt;\n                &lt;timestamp&gt;2015-01-23T22:10:18+01:00&lt;/timestamp&gt;\n                &lt;expires&gt;2020-01-31T22:10:08+01:00&lt;/expires&gt;\n                &lt;datapart&gt;\n                    &lt;par n=\"parameter\"&gt;6.29&lt;/par&gt;\n                    &lt;par n=\"value\"&gt;temp&lt;/par&gt;\n                    &lt;par n=\"timestamp\"&gt;2015-01-22 16:00:00&lt;/par&gt;\n                    &lt;par n=\"entity\"&gt;imei&lt;/par&gt;\n                    &lt;par n=\"scope\"&gt;cell&lt;/par&gt;\n                    &lt;par n=\"idsensor\"&gt;&lt;/par&gt;\n                &lt;/datapart&gt;\n            &lt;/ctxEl&gt;\n            &lt;ctxEl&gt;\n                &lt;contextProvider id=\"MyClient\" v=\"1.2.1\"&gt;&lt;/contextProvider&gt;\n                &lt;entity id=\"123456789123\" type=\"imei\"&gt;&lt;/entity&gt;\n                &lt;scope&gt;cell&lt;/scope&gt;\n                &lt;timestamp&gt;2015-01-21T22:10:18+01:00&lt;/timestamp&gt;\n                &lt;expires&gt;2020-01-31T22:10:08+01:00&lt;/expires&gt;\n                &lt;datapart&gt;\n                    &lt;par n=\"parameter\"&gt;6.98&lt;/par&gt;\n                    &lt;par n=\"value\"&gt;temp&lt;/par&gt;\n                    &lt;par n=\"timestamp\"&gt;2015-01-22 15:00:00&lt;/par&gt;\n                    &lt;par n=\"entity\"&gt;imei&lt;/par&gt;\n                    &lt;par n=\"scope\"&gt;cell&lt;/par&gt;\n                    &lt;par n=\"idsensor\"&gt;&lt;/par&gt;\n                &lt;/datapart&gt;\n            &lt;/ctxEl&gt;\n            &lt;ctxEl&gt;\n                &lt;contextProvider id=\"MyClient\" v=\"1.2.1\"&gt;&lt;/contextProvider&gt;\n                &lt;entity id=\"123456789123\" type=\"imei\"&gt;&lt;/entity&gt;\n                &lt;scope&gt;cell&lt;/scope&gt;\n                &lt;timestamp&gt;2015-01-23T22:10:18+01:00&lt;/timestamp&gt;\n                &lt;expires&gt;2020-01-31T22:10:08+01:00&lt;/expires&gt;\n                &lt;datapart&gt;\n                    &lt;par n=\"parameter\"&gt;6.94&lt;/par&gt;\n                    &lt;par n=\"value\"&gt;temp&lt;/par&gt;\n                    &lt;par n=\"timestamp\"&gt;2015-01-22 14:00:00&lt;/par&gt;\n                    &lt;par n=\"entity\"&gt;imei&lt;/par&gt;\n                    &lt;par n=\"scope\"&gt;cell&lt;/par&gt;\n                    &lt;par n=\"idsensor\"&gt;&lt;/par&gt;\n                &lt;/datapart&gt;\n            &lt;/ctxEl&gt;\n        &lt;/ctxEls&gt;\n    &lt;/contextML&gt;\n</pre>\n<br/>\n<ins>\n <strong>\n  b\n </strong>\n ) Analyzed data:\n</ins>\n sample which provides the last analyzed values.\n\n\t<p>\n <ins>\n  MeteoAnalysis class:_\n </ins>\n The class of the information model which stores the analyzed data is MeteoAnalysis. This class stores the analysis results of the predictions stored in \u201cMeteo\u201d table and supports the service \"predicciones ()\" to retrieve the analyzed data.\n</p>\n\n<p style=\"text-align:center;\">\n <img alt=\"\" src=\"images/redmine/MeteoAnalysis.png\" class=img-responsive />\n</p>\n\n<p>\n This method accepts GET parameters:\n</p>\n\n<ul>\n <li>\n  <em>\n   method\n  </em>\n  It shall be a String, representing the format of output data. There are two possible values:\n  <ul>\n   <li>\n    json\n   </li>\n   <li>\n    xml\n   </li>\n  </ul>\n </li>\n <li>\n  <em>\n   fecha_ini\n  </em>\n  It shall be an Integer representing a date in UNIX_TIMESTAMP format.\n </li>\n <li>\n  <em>\n   fecha_fin\n  </em>\n  It shall be an Integer representing a date in UNIX_TIMESTAMP format.\n </li>\n</ul>\n\n<p>\n <em>\n  Example\n </em>\n</p>\n\n<blockquote>\n <p>\n  GET\n </p>\n</blockquote>\n\n<pre>\nhttp://s414608724.mialojamiento.es/FINESCE/api/{module_name}/{function_name}/?parameters\n</pre>\n\n<blockquote>\n <p>\n  Example using JSON\n </p>\n</blockquote>\n\n<pre>\nhttp://s414608724.mialojamiento.es/FINESCE/api/wf/predicciones/?method=json&amp;fecha_ini=1421931600&amp;fecha_fin=1421942400\n\nREQUEST\n\nACCEPT     \n    application/json\n\nRESPONSE\n\nResponse code:     \n    200 OK\nContent-Type:        \n    application/json\nResponse body:    \n    {\"meteo\": [\n        { \n            \"parameter\":\"temp\" ,  \n            \"value\":\"6.29\" ,  \n            \"value_correction\":\"5.81\" ,  \n            \"timestamp\":\"2015-01-22 16:00:00\" ,  \n            \"entity\":\"meteo\" ,  \n            \"scope\":\"analysis\" \n        },\n        { \n            \"parameter\":\"temp\" ,  \n            \"value\":\"6.98\" ,  \n            \"value_correction\":\"6.98\" ,  \n            \"timestamp\":\"2015-01-22 15:00:00\" ,  \n            \"entity\":\"meteo\" ,  \n            \"scope\":\"cell\" \n        },\n        { \n            \"parameter\":\"temp\" ,  \n            \"value\":\"6.94\" ,  \n            \"value_correction\":\"6.94\" ,  \n            \"timestamp\":\"2015-01-22 14:00:00\" ,  \n            \"entity\":\"meteo\" ,  \n            \"scope\":\"cell\" \n        }\n    ]}\n</pre>\n\n<blockquote>\n <p>\n  Example using XML\n </p>\n</blockquote>\n\n<pre>\nhttp://s414608724.mialojamiento.es/FINESCE/api/wf/predicciones/?method=xml&amp;fecha_ini=1421931600&amp;fecha_fin=1421942400\n\nREQUEST\n\nACCEPT     \n    application/xml\n\nRESPONSE\nResponse code:     \n    200 OK\nContent-Type:        \n    application/xml\nResponse body:    \n    &lt;contextML xmlns=\"http://ContextML/1.7\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"  xsi:schemaLocation=\"http://ContextML/1.7 ../ContextML-1.7.xsd\"&gt;\n        &lt;ctxEls&gt;\n            &lt;ctxEl&gt;\n                &lt;contextProvider id=\"MyClient\" v=\"1.2.1\"&gt;&lt;/contextProvider&gt;\n                &lt;entity id=\"123456789123\" type=\"imei\"&gt;&lt;/entity&gt;\n                &lt;scope&gt;cell&lt;/scope&gt;\n                &lt;timestamp&gt;2015-01-23T22:10:18+01:00&lt;/timestamp&gt;\n                &lt;expires&gt;2020-01-31T22:10:08+01:00&lt;/expires&gt;\n                &lt;datapart&gt;\n                    &lt;par n=\"parameter\"&gt;6.29&lt;/par&gt;\n                    &lt;par n=\"value\"&gt;temp&lt;/par&gt;\n                    &lt;par n=\"value_correction\"&gt;5.81&lt;/par&gt;\n                    &lt;par n=\"timestamp\"&gt;2015-01-22 16:00:00&lt;/par&gt;\n                    &lt;par n=\"entity\"&gt;imei&lt;/par&gt;\n                    &lt;par n=\"scope\"&gt;analysis&lt;/par&gt;\n                    &lt;par n=\"idsensor\"&gt;&lt;/par&gt;\n                &lt;/datapart&gt;\n            &lt;/ctxEl&gt;\n            &lt;ctxEl&gt;\n                &lt;contextProvider id=\"MyClient\" v=\"1.2.1\"&gt;&lt;/contextProvider&gt;\n                &lt;entity id=\"123456789123\" type=\"imei\"&gt;&lt;/entity&gt;\n                &lt;scope&gt;cell&lt;/scope&gt;\n                &lt;timestamp&gt;2015-01-21T22:10:18+01:00&lt;/timestamp&gt;\n                &lt;expires&gt;2020-01-31T22:10:08+01:00&lt;/expires&gt;\n                &lt;datapart&gt;\n                    &lt;par n=\"parameter\"&gt;6.98&lt;/par&gt;\n                    &lt;par n=\"value\"&gt;temp&lt;/par&gt;\n                    &lt;par n=\"value_correction\"&gt;6.98&lt;/par&gt;\n                    &lt;par n=\"timestamp\"&gt;2015-01-22 15:00:00&lt;/par&gt;\n                    &lt;par n=\"entity\"&gt;imei&lt;/par&gt;\n                    &lt;par n=\"scope\"&gt;analysis&lt;/par&gt;\n                    &lt;par n=\"idsensor\"&gt;&lt;/par&gt;\n                &lt;/datapart&gt;\n            &lt;/ctxEl&gt;\n            &lt;ctxEl&gt;\n                &lt;contextProvider id=\"MyClient\" v=\"1.2.1\"&gt;&lt;/contextProvider&gt;\n                &lt;entity id=\"123456789123\" type=\"imei\"&gt;&lt;/entity&gt;\n                &lt;scope&gt;cell&lt;/scope&gt;\n                &lt;timestamp&gt;2015-01-23T22:10:18+01:00&lt;/timestamp&gt;\n                &lt;expires&gt;2020-01-31T22:10:08+01:00&lt;/expires&gt;\n                &lt;datapart&gt;\n                    &lt;par n=\"parameter\"&gt;6.94&lt;/par&gt;\n                    &lt;par n=\"value\"&gt;temp&lt;/par&gt;\n                    &lt;par n=\"value_correction\"&gt;6.94&lt;/par&gt;\n                    &lt;par n=\"timestamp\"&gt;2015-01-22 14:00:00&lt;/par&gt;\n                    &lt;par n=\"entity\"&gt;imei&lt;/par&gt;\n                    &lt;par n=\"scope\"&gt;analysis&lt;/par&gt;\n                    &lt;par n=\"idsensor\"&gt;&lt;/par&gt;\n                &lt;/datapart&gt;\n            &lt;/ctxEl&gt;\n        &lt;/ctxEls&gt;\n    &lt;/contextML&gt;\n</pre>\n\n\n<h3>\n DSE Interwork\n</h3>\n\n<p>\n <img alt=\"\" src=\"images/redmine/DSE_Interwork_Temporal_Consistency.png\" class=img-responsive />\n</p>\n\n<p>\n Temporal Consistency is a DSE developed for working together with the Big Data Analysis \u2013 Cosmos GE. It is also related to the Publish/Subscribe Context Broker \u2013 Orion GE, since the latter is necessary for inserting data into Cosmos, through the Cygnus module. Orion connects each of the trial building subsystems (e.g. weather forecast service, wireless metering and monitoring system, etc.) with the persistent data storage cluster of Cosmos.\n</p>\n\n<p>\n Another important component in the interaction of the DSE with Generic Enablers is the HiveQL Client, which is a SQL-based database querying language which supports analysis of large datasets stored in Hadoop distributed file systems. HiveQL is used by the Temporal Consistency DSE for performing programmed queries to the database.\n</p>\n\n\n\nThe configuration steps which are followed to integrate the Big Data Analysis \u2013 Cosmos and Orion CB with the Madrid trial infrastructure are the following:\n\t<ul>\n <li>\n  Entities with the necessary parameters are created in the Orion CB GE.\n </li>\n <li>\n  Subscriptions are created in the previous entities for the parameters which are required.\n </li>\n <li>\n  Datasets and tables are created in Cosmos GE for storage of data.\n </li>\n <li>\n  A process is launched, which will be executing continuously, for parsing the XML files coming from the trial subsystems, in order to inject them in Cosmos.\n </li>\n <li>\n  Lastly, data output from the trial subsystems is programmed through Java tasks in charge of sending the most recent data through REST requests.\n </li>\n</ul>\n\n\n<h3>\n GE Dependencies\n</h3>\n\n<p>\n The implementation of this DSE is working with an instance of Orion v0.22, and Cygnus v4.4 (module used to insert data in Cosmos)\n</p>\n\n\n",
            "Copyright": "\n<p>\n Copyright \u00a9 2015 by FINESCE\n</p>\n\n\n",
            "Glossary": "",
            "References": "",
            "Details": "",
            "Preface": "\n<p>\n Within this document you find a self-contained open specification of the aforementioned Domain Specific Enabler (DSE).\n</p>\n\n<p>\n Please consult the appropriate pages on the\n <a class=\"external\" href=\"http://www.finesce.eu/Trial_Site_Madrid.html\">\n  FINESCE\n </a>\n website in order to understand the complete context of the related FINESCE trials and this DSE.\n</p>\n\n\n",
            "ReutilisedTech": "\n<p>\n The Temporal Consistency DSE relies on the Big Data Analysis - Cosmos GE and the Publish/Subscribe Context Broker - Orion Context Broker GE from FIWARE\n</p>\n\n\n"
        },
        "Version": "1.0",
        "WP": "",
        "Usage": "\n\n<h3>\n Installation guide\n</h3>\n\n\n\nThe Temporal Consistency DSE runs under Java JRE7, which can be downloaded from <a class=\"external\" href=\"https://www.oracle.com/downloads/index.htm\">\n https://www.oracle.com/downloads/index.htm\n</a>\n. The DSE comprises the following modules:\n\t<ul>\n <li>\n  Java process for data analysis\n </li>\n <li>\n  Database for storing processed data, so that they can be shown through an user interface. For the reference implementation the database used has been SQL Server 2012.\n </li>\n</ul>\n\n<p>\n The data analysis process consists of a .jar executable file. To run it, it is need to place the file within the Java installation folder, or modify the environment variable \"classpath\" directory where it is located.\n</p>\n\n<p>\n Before running the process, it is needed to have access to Cosmos enabled by Telef\u00f3nica, for which, the server where the analysis process runs must have a fixed public IP. Contact person from Telefonica for Cosmos, at the time of the implementation, was Francisco Romero Bueno (\n <a class=\"email\" href=\"mailto:frb@tid.es\">\n  frb@tid.es\n </a>\n ).\n</p>\n\n<p>\n To run the process, it is need to run the following statement through the command line:\n <br/>\n <code>\n  java \u2013jar {PATH_TO_FILE} /HiveClientProject.jar\n </code>\n</p>\n\n<p>\n The process will run continuously, conducting regular analysis of the data stored in Cosmos. These data are automatically saved to the database, so they can be displayed through any user interface.\n</p>\n\n<p>\n In the Madrid trial a SqlServer 2012 database has been used, but with the appropriate connectors it is possible to use any other database engine.\n</p>\n\n\n\nThe system uses a table in the database server where a record is kept for each execution of the data analysis algorithm. Each record contains the following fields:\n\t<ul>\n <li>\n  <em>\n   fecha\n  </em>\n  : datetime of the analysis\n </li>\n <li>\n  <em>\n   mensaje\n  </em>\n  : body of the message\n </li>\n <li>\n  <em>\n   modulo\n  </em>\n  : trial module which has generated the message (WF, MG, WSN or CCE).\n </li>\n</ul>\n\n<p>\n The structure of the field\n <em>\n  mensaje\n </em>\n , which contains the relevant information from the analysis, is shown below:\n <br/>\n datetime$timestamp$parameter$average$difference$correct$last_prediction$correction_factor**\n <br/>\n <em>\n  correction_factor** : tolerance * average_deviation\n </em>\n</p>\n\n<p>\n The script for table creation in the database is:\n</p>\n\n<pre>\n<code>\nCREATE TABLE [dbo].[FINESCE_hiveResults](\n    [fecha] [datetime] NULL,\n    [mensaje] [text] NULL,\n    [modulo] [text] NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\n</code><br/></pre>\n\n<p>\n At this point the developer will have all the data to show through any appropriate GUI to the end user, or through an API.\n</p>\n\n\n<h3>\n Usage example\n</h3>\n\n<p>\n This section describes how to deploy an instance of the Temporal Consistency DSE, providing as usage example the case of the FINESCE Madrid trial. In this example the Temporal Consistency DSE is set to work together with the following components:\n</p>\n\n<ul>\n <li>\n  An instance of Orion Context Broker GE\n </li>\n <li>\n  Big Data/Cosmos GE\n </li>\n <li>\n  Java Schedule task\n </li>\n <li>\n  MySQL database\n </li>\n <li>\n  Graphical User Interface (GUI)\n </li>\n</ul>\n\n<p>\n <ins>\n  Common Steps\n </ins>\n</p>\n\n<p>\n <em>\n  Database Configuration\n </em>\n</p>\n\n<p>\n The first step is the creation of the database where the results of the analysis done through the DSE will be stored, and to make this database accessible for web visualization. The configuration parameters of the MySQL database in PHP are:\n</p>\n\n<p>\n <code>\n  var $_dbDriver = \"mysql\";\n  <br/>\n  var $_dbHostname = \"XXX.XX.XX.XX\";\n  <br/>\n  var $_dbDatabase = \"MeteoTICs\";\n  <br/>\n  var $_dbUser = \"finesce\";\n  <br/>\n  var $_dbPass = \"*******\";\n </code>\n</p>\n\n<p>\n The structure of the database table where the analysis will be stored is the following:\n</p>\n\n<pre>\nCREATE TABLE FINESCE_results(\n    fecha datetime NULL,\n    mensaje text NULL,\n    modulo text NULL\n) ON PRIMARY TEXTIMAGE_ON PRIMARY\n</pre>\n\n<p>\n Every analysis performed will be reflected in the database as a new record in the table, so that it can be accessed through any desired visualization method.\n</p>\n\n<p>\n The field\n <code>\n  mensaje\n </code>\n will store a frame with the following format:\n</p>\n\n<p>\n <code>\n  datetime$timestamp$parameter$average$difference$correct$tolerance*deviation\n </code>\n</p>\n\n\n\nThe frame is composed of the following fields:\n\t<ul>\n <li>\n  datetime: datetime associated to the frame\n </li>\n <li>\n  timestamp: datetime associated in timestamp format\n </li>\n <li>\n  parameter: parameter name\n </li>\n <li>\n  average: parameter average value in the last days\n </li>\n <li>\n  difference: difference between value and average\n </li>\n <li>\n  correct: boolean\n </li>\n <li>\n  value: parameter value (float)\n </li>\n <li>\n  tolerance*deviation: tolerance factor * deviation from value to average\n </li>\n</ul>\n\n<p>\n For instance:\n</p>\n\n<p>\n <code>\n  Wed Jul 08 06:18:06 CEST 2015$1436329086976$temp$0.0$-0.53999996$0$15.13$0.0\n </code>\n</p>\n\n<p>\n <em>\n  Orion Context Broker GE Configuration\n </em>\n</p>\n\n<p>\n Orion Context Broker must be configured so that it can load the data that arrive directly in the dataset associated to Cosmos. For doing so, a connection with the Orion Context Broker instance must be established, and the following actions have to be carried out:\n</p>\n\n<ul>\n <li>\n  Start the contextBroker process:\n </li>\n</ul>\n\n<p>\n <code>\n  /etc/init.d/contextBroker start\n </code>\n</p>\n\n<ul>\n <li>\n  Creation of entities\n </li>\n</ul>\n\n<p>\n An entity must be created for each module. The tag \u201ccontextAttributeList\u201d contains as many items as parameters of each entity will be stored in Cosmos. The following example shows the creation of the entity \u201cfinesce_meteo\u201d:\n</p>\n\n<pre>\n(curl localhost:1026/NGSI10/updateContext -s -S --header 'Content-Type: application/xml' -d @- | xmllint --format - ) &lt;&lt;EOF\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;updateContextRequest&gt;\n  &lt;contextElementList&gt;\n    &lt;contextElement&gt;\n      &lt;entityId type=\"finesce_meteo\" isPattern=\"false\"&gt;\n        &lt;id&gt;finesce_meteo&lt;/id&gt;\n      &lt;/entityId&gt;\n      &lt;contextAttributeList&gt;\n        &lt;contextAttribute&gt;\n          &lt;name&gt;dirviento&lt;/name&gt;\n          &lt;type&gt;grad&lt;/type&gt;\n          &lt;contextValue&gt;260&lt;/contextValue&gt;\n        &lt;/contextAttribute&gt;\n        &lt;contextAttribute&gt;\n          &lt;name&gt;modviento&lt;/name&gt;\n          &lt;type&gt;ms&lt;/type&gt;\n          &lt;contextValue&gt;2&lt;/contextValue&gt;\n        &lt;/contextAttribute&gt;\n        &lt;contextAttribute&gt;\n          &lt;name&gt;humrel&lt;/name&gt;\n          &lt;type&gt;pct&lt;/type&gt;\n          &lt;contextValue&gt;2&lt;/contextValue&gt;\n        &lt;/contextAttribute&gt;\n        &lt;contextAttribute&gt;\n          &lt;name&gt;precip&lt;/name&gt;\n          &lt;type&gt;mmh&lt;/type&gt;\n          &lt;contextValue&gt;2&lt;/contextValue&gt;\n        &lt;/contextAttribute&gt;\n        &lt;contextAttribute&gt;\n          &lt;name&gt;temp&lt;/name&gt;\n          &lt;type&gt;C&lt;/type&gt;\n          &lt;contextValue&gt;2&lt;/contextValue&gt;\n        &lt;/contextAttribute&gt;\n      &lt;/contextAttributeList&gt;\n    &lt;/contextElement&gt;\n  &lt;/contextElementList&gt;\n  &lt;updateAction&gt;APPEND&lt;/updateAction&gt;\n&lt;/updateContextRequest&gt;\nEOF\n</pre>\n\n<p>\n This other example shows the creation of the \u201cfinesce_wsn\u201d entity:\n</p>\n\n<pre>\n(curl localhost:1026/NGSI10/updateContext -s -S --header 'Content-Type: application/xml' -d @- | xmllint --format - ) &lt;&lt;EOF\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;updateContextRequest&gt;\n  &lt;contextElementList&gt;\n    &lt;contextElement&gt;\n      &lt;entityId type=\"finesce_wsn\" isPattern=\"false\"&gt;\n        &lt;id&gt;finesce_wsn&lt;/id&gt;\n      &lt;/entityId&gt;\n      &lt;contextAttributeList&gt;\n        &lt;contextAttribute&gt;\n          &lt;name&gt;medida&lt;/name&gt;\n          &lt;type&gt;string&lt;/type&gt;\n          &lt;contextValue&gt;x&lt;/contextValue&gt;\n        &lt;/contextAttribute&gt;\n        &lt;contextAttribute&gt;\n          &lt;name&gt;magnitud&lt;/name&gt;\n          &lt;type&gt;string&lt;/type&gt;\n          &lt;contextValue&gt;x&lt;/contextValue&gt;\n        &lt;/contextAttribute&gt;\n        &lt;contextAttribute&gt;\n          &lt;name&gt;valor&lt;/name&gt;\n          &lt;type&gt;float&lt;/type&gt;\n          &lt;contextValue&gt;0.0&lt;/contextValue&gt;\n        &lt;/contextAttribute&gt;\n        &lt;contextAttribute&gt;\n          &lt;name&gt;fecha&lt;/name&gt;\n          &lt;type&gt;s&lt;/type&gt;\n          &lt;contextValue&gt;0&lt;/contextValue&gt;\n        &lt;/contextAttribute&gt;\n        &lt;contextAttribute&gt;\n          &lt;name&gt;idsensor&lt;/name&gt;\n          &lt;type&gt;int&lt;/type&gt;\n          &lt;contextValue&gt;0&lt;/contextValue&gt;\n        &lt;/contextAttribute&gt;\n      &lt;/contextAttributeList&gt;\n    &lt;/contextElement&gt;\n  &lt;/contextElementList&gt;\n  &lt;updateAction&gt;APPEND&lt;/updateAction&gt;\n&lt;/updateContextRequest&gt;\nEOF\n</pre>\n\n<ul>\n <li>\n  Cygnus configuration\n </li>\n</ul>\n\n<p>\n Cygnus is a connector in charge of persisting Orion context data in certain configured third-party storages, creating a historical view of such data. Cygnus is based internally on Flume, which is a distributed, reliable, and available service for efficiently collecting, aggregating, and moving large amounts of streaming event data.\n</p>\n\n<pre>\n# dataset where to persist the data (/user/myusername/mydataset)\ncygnusagent.sinks.hdfs-sink.cosmos_dataset = finesce_meteo\n# listening port the Flume source will use for receiving incoming notifications\ncygnusagent.sources.http-source-wsn.port = 5051\n</pre>\n\n<ul>\n <li>\n  Start a Cygnus instance\n </li>\n</ul>\n\n<pre>\n# nohup /root/APACHE_FLUME_HOME/bin/flume-ng agent --conf /root/APACHE_FLUME_HOME/conf -f /root/APACHE_FLUME_HOME/conf/cygnus_meteo.conf -n cygnusagent -Dflume.root.logger=INFO,LOGFILE_METEO &amp;\n</pre>\n\n<p>\n <em>\n  <ins>\n   Subscriptions creation (one for each entity parameter)\n  </ins>\n </em>\n</p>\n\n<pre>\n (curl localhost:1026/NGSI10/subscribeContext -s -S --header 'Content-Type: application/xml' -d @- | xmllint --format -) &lt;&lt;EOF\n&lt;?xml version=\"1.0\"?&gt;\n&lt;subscribeContextRequest&gt;\n  &lt;entityIdList&gt;\n    &lt;entityId type=\"finesce_meteo\" isPattern=\"false\"&gt;\n      &lt;id&gt;Finesce_Meteo1&lt;/id&gt;\n    &lt;/entityId&gt;\n  &lt;/entityIdList&gt;\n  &lt;attributeList&gt;\n    &lt;attribute&gt;&lt;/attribute&gt;\n  &lt;/attributeList&gt;\n  &lt;reference&gt;http://localhost:1028/accumulate&lt;/reference&gt;\n  &lt;duration&gt;P1M&lt;/duration&gt;\n  &lt;notifyConditions&gt;\n    &lt;notifyCondition&gt;\n      &lt;type&gt;ONCHANGE&lt;/type&gt;\n      &lt;condValueList&gt;\n        &lt;condValue&gt;dirviento&lt;/condValue&gt;\n      &lt;/condValueList&gt;\n    &lt;/notifyCondition&gt;\n  &lt;/notifyConditions&gt;\n  &lt;throttling&gt;PT5S&lt;/throttling&gt;\n&lt;/subscribeContextRequest&gt;\nEOF\n</pre>\n\n<ul>\n <li>\n  Cosmos dataset creation\n </li>\n</ul>\n\n<p>\n A dataset is created in Cosmos in order to store the data:\n</p>\n\n<pre>\nhive&gt; create external table finesce_meteo (name string, planet string, profession string, age int) row format delimited fields terminated by ',' location '/user/finesce/input/structured/';\n</pre>\n\n<p>\n <em>\n  Java Schedule task configuration\n </em>\n</p>\n\n<p>\n In order to start the scheduled analysis tasks of Temporal Consistency DSE it is necessary to execute the program HiveClientProject.jar. In order to do so, version 7 of Java must be installed in the server. The program is executed through the following statement:\n</p>\n\n<p>\n <code>\n  java \u2013jar HiveClientProject.jar\n </code>\n</p>\n\n<p>\n <em>\n  Insertion of new data in Cosmos\n </em>\n</p>\n\n<p>\n Every module (i.e. system/subsystem generating data streams) that connects to the platform must be able to send data to Cosmos through a XML format as the following:\n</p>\n\n<pre>\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt; \n&lt;updateContextRequest&gt;\n    &lt;contextElementList&gt;\n        &lt;contextElement&gt;\n            &lt;entityId type=\"finesce_meteo\" isPattern=\"false\"&gt;\n                &lt;id&gt;finesce_meteo&lt;/id&gt; \n            &lt;/entityId&gt;\n            &lt;contextAttributeList&gt;\n                &lt;contextAttribute&gt;\n                    &lt;name&gt;temp&lt;/name&gt; \n                    &lt;type&gt;C&lt;/type&gt; \n                    &lt;contextValue&gt;4.89&lt;/contextValue&gt; \n                &lt;/contextAttribute&gt;\n                &lt;contextAttribute&gt;\n                    &lt;name&gt;humrel&lt;/name&gt; \n                    &lt;type&gt;pct&lt;/type&gt; \n                    &lt;contextValue&gt;0.88&lt;/contextValue&gt; \n                &lt;/contextAttribute&gt;\n                &lt;contextAttribute&gt;\n                    &lt;name&gt;precip&lt;/name&gt; \n                    &lt;type&gt;mmh&lt;/type&gt; \n                    &lt;contextValue&gt;0.0315&lt;/contextValue&gt; \n                &lt;/contextAttribute&gt;\n                &lt;contextAttribute&gt;\n                    &lt;name&gt;modviento&lt;/name&gt; \n                    &lt;type&gt;ms&lt;/type&gt; \n                    &lt;contextValue&gt;0.01&lt;/contextValue&gt; \n                &lt;/contextAttribute&gt;\n                &lt;contextAttribute&gt;\n                    &lt;name&gt;dirviento&lt;/name&gt; \n                    &lt;type&gt;grad&lt;/type&gt; \n                    &lt;contextValue&gt;265&lt;/contextValue&gt; \n                &lt;/contextAttribute&gt;\n                &lt;contextAttribute&gt;\n                    &lt;name&gt;cc&lt;/name&gt; \n                    &lt;type&gt;pct&lt;/type&gt; \n                    &lt;contextValue&gt;0.2&lt;/contextValue&gt; \n                &lt;/contextAttribute&gt;\n            &lt;/contextAttributeList&gt;\n        &lt;/contextElement&gt;\n    &lt;/contextElementList&gt;\n    &lt;updateAction&gt;APPEND&lt;/updateAction&gt; \n&lt;/updateContextRequest&gt;\n</pre>\n\n<p>\n For every module, a XML will be sent coherent with the attributes that need to be stored in Cosmos.\n <br/>\n The entities created in Orion must be coherent with the number of modules (i.e. system/subsystem generating data streams) from which data are stored.\n <br/>\n There must be so many subscriptions created in Orion as the number of attributes stored for each module.\n</p>\n\n<p>\n In order to test the proper operation of Orion, the following instruction, that shows the active subscriptions whose parameter is referencing to \u2018temp\u2019, can be executed, replacing the name of the attribute, and checking that with every data sending done from the modules, in the answer received from the instruction the attribute count is incremented, and the attribute lastNotification is updated with the timestamp corresponding to the instant when data are sent from the modules.\n</p>\n\n<pre>\necho 'db.csubs.find({attrs:\u201dtemp\u201d}).pretty()' | mongo orion\n\n{\n        \"_id\" : ObjectId(\"54c2298b286043784451d084\"),\n        \"expiration\" : NumberLong(\"4575610763\"),\n        \"reference\" : \"http://localhost:5050/notify\",\n        \"throttling\" : NumberLong(5),\n        \"entities\" : [\n                {\n                        \"id\" : \"finesce_meteo\",\n                        \"type\" : \"finesce_meteo\",\n                        \"isPattern\" : \"false\" \n                }\n        ],\n        \"attrs\" : [\n                \"temp\" \n        ],\n        \"conditions\" : [\n                {\n                        \"type\" : \"ONCHANGE\",\n                        \"value\" : [\n                                \"temp\" \n                        ]\n                }\n        ],\n        \"lastNotification\" : 1441187336,\n        \"count\" : 1713,\n        \"format\" : \"XML\" \n}\n</pre>\n\n<p>\n <em>\n  Visualization configuration\n </em>\n</p>\n\n<p>\n A web page is used as GUI for displaying the data analysis performed in the trial. This tool is fed with the database where the Schedule task dumps the data of the analysis performed periodically. In order to deploy this GUI, there must be installed an Apache server with PHP and MySQL. Packages such as wamp are recommended in order to facilitate the GUI deployment.\n</p>\n\n\n",
        "Terms and Conditions": "\n<p>\n This DSE is provided as open source under the Apache2 license. Please check the specific terms and conditions linked to this open source license at\n <a class=\"external\" href=\"http://www.apache.org/licenses/LICENSE-2.0\">\n  http://www.apache.org/licenses/LICENSE-2.0\n </a>\n .\n</p>\n\n\n",
        "wiki_attachments": [
            "/redmine/attachments/download/2158/TemporalConsistencyDSE.png",
            "/redmine/attachments/download/2182/ClassMeteo.png",
            "/redmine/attachments/download/2185/MeteoAnalysis.png",
            "/redmine/attachments/download/2634/HiveClientProject.zip",
            "/redmine/attachments/download/2878/DSE_Interwork_Temporal_Consistency.png"
        ],
        "Open Source": "",
        "Contact Person": "\n<p>\n Jos\u00e9 Luis Bur\u00f3n\n <br/>\n ACCIONA Infraestructuras\n <br/>\n <a class=\"email\" href=\"mailto:joseluis.buron.martinezREMOVE-NO-SPAM@acciona.com\">\n  joseluis.buron.martinezREMOVE-NO-SPAM@acciona.com\n </a>\n</p>\n\n\n",
        "Overview": "\n\n<h3>\n What you get\n</h3>\n\n<p>\n Temporal Consistency DSE is a module which can be used by client applications (e.g. Building Energy Management Systems) for applying processing algorithms to data streams (e.g. weather forecasts, sensor measurements) that are used as inputs by those clients, in order to detect erroneous/inconsistent data in those streams, and replace them with alternative values, calculated through an algorithm based on historical data from the same data stream.\n</p>\n\n<p>\n The ultimate goal of this DSE is to help ensure that data inputs in energy management systems are accurate enough for its use in different applications. An example of such applications can be the calculation of: building models, energy control set points, or energy savings achieved through energy efficiency projects.\n <br/>\n The reference implementation provided shows the application of the DSE for processing weather forecasts collected from an internet web service, in order to use the refined data as an input to a building remote energy control system.\n</p>\n\n<p>\n DSE Version: 1.0\n</p>\n\n\n<h3>\n Why to get it\n</h3>\n\n<p>\n A reference implementation of a module for processing data streams handled by Big Data Analysis \u2013 Cosmos GE and Orion Context Broker GE.\n</p>\n\n\n<h3>\n Target Usage\n</h3>\n\n<p>\n This DSE aims to be a module which can be integrated in energy management systems whose data inputs need to be processed in order to ensure their correctness and accuracy. It is therefore useful for energy management system developers and integrators, who can adapt the DSE in order to apply it to the specific data streams they need to process.\n</p>\n\n\n",
        "Downloads": "\n<table class=\"themed\">\n <tr class=\"top\">\n  <td>\n   Location\n  </td>\n  <td>\n   Revision\n  </td>\n  <td>\n   Release Date\n  </td>\n </tr>\n <tr>\n  <td>\n   <a class=\"external\" href=\"files/HiveClientProject.zip\">\n    HiveClientProject.zip\n   </a>\n  </td>\n  <td>\n   version=1.0\n  </td>\n  <td>\n   Wed Jun 24th 14:12:00 CEST 2015\n  </td>\n </tr>\n</table>\n\n<p>\n The ZIP file provided includes both the executable .jar file and the source code.\n</p>\n\n\n",
        "Instances": "\n<p>\n An instance of this DSE\u2019s reference implementation runs as a part of the trial and is not publicly accessible.\n</p>\n\n\n"
    }
]